{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///D:/search-engine-spec/lib/db.ts"],"sourcesContent":["import { Pool } from '@neondatabase/serverless';\r\nimport * as dotenv from 'dotenv';\r\n\r\ndotenv.config({ path: '.env.local' });\r\ndotenv.config({ path: '.env' });\r\n\r\nconsole.log('Initializing Neon DB pool...');\r\n\r\nconst pool = new Pool({\r\n    connectionString: process.env.DATABASE_URL || 'postgresql://postgres:postgres@localhost:5432/search_engine',\r\n    ssl: true,\r\n});\r\n\r\nexport default pool;\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,iJAAa,CAAC;IAAE,MAAM;AAAa;AACnC,iJAAa,CAAC;IAAE,MAAM;AAAO;AAE7B,QAAQ,GAAG,CAAC;AAEZ,MAAM,OAAO,IAAI,gKAAI,CAAC;IAClB,kBAAkB,QAAQ,GAAG,CAAC,YAAY,IAAI;IAC9C,KAAK;AACT;uCAEe"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///D:/search-engine-spec/lib/services/metrics-service.ts"],"sourcesContent":["import pool from '../db';\r\n\r\nexport class MetricsService {\r\n    async getIndexStats() {\r\n        const docCount = await pool.query('SELECT COUNT(*) FROM documents');\r\n        const queueCount = await pool.query('SELECT COUNT(*) FROM crawl_queue WHERE status = \\'pending\\'');\r\n\r\n        // Mocking some data that would come from Elasticsearch or internal metrics\r\n        return {\r\n            index: {\r\n                total_documents: parseInt(docCount.rows[0].count),\r\n                total_terms: 5420000, // Mock\r\n                total_size_gb: 3200, // Mock\r\n                shards: {\r\n                    total: 64,\r\n                    active: 64,\r\n                    relocating: 0,\r\n                    initializing: 0,\r\n                    unassigned: 0\r\n                },\r\n                replication: {\r\n                    factor: 3,\r\n                    lag_seconds: 2.5\r\n                }\r\n            },\r\n            health: {\r\n                status: \"green\",\r\n                nodes: 21,\r\n                data_nodes: 21\r\n            },\r\n            performance: {\r\n                indexing_rate_docs_per_sec: 1250,\r\n                search_rate_queries_per_sec: 45000,\r\n                avg_search_latency_ms: 125\r\n            },\r\n            freshness: {\r\n                last_update: new Date().toISOString(),\r\n                avg_document_age_hours: 4.2,\r\n                high_priority_age_hours: 1.8\r\n            }\r\n        };\r\n    }\r\n\r\n    async getMetrics(period: string) {\r\n        // Mock metrics data\r\n        return {\r\n            period,\r\n            metrics: {\r\n                queries: {\r\n                    total: 162000,\r\n                    success_rate: 0.998,\r\n                    avg_latency_ms: 145,\r\n                    p50_latency_ms: 120,\r\n                    p95_latency_ms: 185,\r\n                    p99_latency_ms: 245\r\n                },\r\n                crawler: {\r\n                    urls_crawled: parseInt((await pool.query(\"SELECT COUNT(*) FROM crawl_queue WHERE status = 'completed'\")).rows[0].count),\r\n                    urls_queued: parseInt((await pool.query(\"SELECT COUNT(*) FROM crawl_queue WHERE status = 'pending'\")).rows[0].count),\r\n                    success_rate: 0.94, // Keep mock for now until we track failures better\r\n                    avg_fetch_time_ms: 850,\r\n                    bandwidth_mbps: 450\r\n                },\r\n                indexing: {\r\n                    documents_indexed: 118000,\r\n                    indexing_rate: 32.8,\r\n                    avg_indexing_latency_ms: 45\r\n                },\r\n                cache: {\r\n                    hit_rate: 0.72,\r\n                    evictions_per_min: 125,\r\n                    size_gb: 48\r\n                }\r\n            }\r\n        };\r\n    }\r\n}\r\n\r\nexport const metricsService = new MetricsService();\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEO,MAAM;IACT,MAAM,gBAAgB;QAClB,MAAM,WAAW,MAAM,sHAAI,CAAC,KAAK,CAAC;QAClC,MAAM,aAAa,MAAM,sHAAI,CAAC,KAAK,CAAC;QAEpC,2EAA2E;QAC3E,OAAO;YACH,OAAO;gBACH,iBAAiB,SAAS,SAAS,IAAI,CAAC,EAAE,CAAC,KAAK;gBAChD,aAAa;gBACb,eAAe;gBACf,QAAQ;oBACJ,OAAO;oBACP,QAAQ;oBACR,YAAY;oBACZ,cAAc;oBACd,YAAY;gBAChB;gBACA,aAAa;oBACT,QAAQ;oBACR,aAAa;gBACjB;YACJ;YACA,QAAQ;gBACJ,QAAQ;gBACR,OAAO;gBACP,YAAY;YAChB;YACA,aAAa;gBACT,4BAA4B;gBAC5B,6BAA6B;gBAC7B,uBAAuB;YAC3B;YACA,WAAW;gBACP,aAAa,IAAI,OAAO,WAAW;gBACnC,wBAAwB;gBACxB,yBAAyB;YAC7B;QACJ;IACJ;IAEA,MAAM,WAAW,MAAc,EAAE;QAC7B,oBAAoB;QACpB,OAAO;YACH;YACA,SAAS;gBACL,SAAS;oBACL,OAAO;oBACP,cAAc;oBACd,gBAAgB;oBAChB,gBAAgB;oBAChB,gBAAgB;oBAChB,gBAAgB;gBACpB;gBACA,SAAS;oBACL,cAAc,SAAS,CAAC,MAAM,sHAAI,CAAC,KAAK,CAAC,8DAA8D,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK;oBACtH,aAAa,SAAS,CAAC,MAAM,sHAAI,CAAC,KAAK,CAAC,4DAA4D,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK;oBACnH,cAAc;oBACd,mBAAmB;oBACnB,gBAAgB;gBACpB;gBACA,UAAU;oBACN,mBAAmB;oBACnB,eAAe;oBACf,yBAAyB;gBAC7B;gBACA,OAAO;oBACH,UAAU;oBACV,mBAAmB;oBACnB,SAAS;gBACb;YACJ;QACJ;IACJ;AACJ;AAEO,MAAM,iBAAiB,IAAI"}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":["file:///D:/search-engine-spec/app/api/v1/admin/metrics/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { metricsService } from '@/lib/services/metrics-service';\r\n\r\nexport async function GET(req: NextRequest) {\r\n    const searchParams = req.nextUrl.searchParams;\r\n    const period = searchParams.get('period') || '1h';\r\n\r\n    try {\r\n        const metrics = await metricsService.getMetrics(period);\r\n        return NextResponse.json(metrics);\r\n    } catch (error) {\r\n        console.error('Metrics error:', error);\r\n        return NextResponse.json({ error: 'Internal server error' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,GAAgB;IACtC,MAAM,eAAe,IAAI,OAAO,CAAC,YAAY;IAC7C,MAAM,SAAS,aAAa,GAAG,CAAC,aAAa;IAE7C,IAAI;QACA,MAAM,UAAU,MAAM,yJAAc,CAAC,UAAU,CAAC;QAChD,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,kBAAkB;QAChC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACJ"}}]
}